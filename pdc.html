<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Percentage Deduction Calculator</title>
    <!-- Use the Inter font from Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Load Tailwind CSS from CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            /* Subtle radial gradient background matching index.html */
            background: radial-gradient(circle at top left, #e0f2fe 0%, #f9fafb 50%, #eef2ff 100%);
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Calculator Main Container (Card) -->
    <div id="calculator-app" class="bg-white rounded-3xl shadow-2xl shadow-blue-200 p-8 sm:p-10 w-full max-w-lg mx-auto transition-all duration-500">

        <div class="flex items-center justify-start mb-8">
             <a href="index.html" class="flex items-center text-blue-600 hover:text-blue-800 transition duration-200">
                <!-- Back Arrow Icon (Lucide-react equivalent using inline SVG for single file) -->
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1">
                    <path d="m15 18-6-6 6-6"/>
                </svg>
                <span class="text-sm font-medium">Back to Hub</span>
            </a>
        </div>

        <!-- Header -->
        <h1 class="text-3xl font-bold text-gray-900 mb-2 tracking-tight">
            Discount and Deduction Tool
        </h1>
        <p class="text-gray-500 mb-8">
            Enter the initial amount to see sequential deductions (5% then 20%). Data saved locally on your device.
        </p>

        <!-- Input Section -->
        <div class="mb-6">
            <label for="inputX" class="block text-left text-sm font-medium text-gray-700 mb-2">Initial Amount (â‚¹)</label>
            <input type="number" id="inputX" placeholder="e.g., 1000" class="w-full p-4 border border-gray-300 rounded-xl text-xl text-center focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition duration-150" autofocus>
        </div>

        <!-- Result Section -->
        <div id="result" class="min-h-[160px] p-6 bg-blue-50 rounded-xl border border-blue-200 transition-all duration-300">
            <p class="text-gray-400 text-center text-lg mt-8">Results will appear here.</p>
        </div>

    </div>

    <!-- Application Logic using LocalStorage -->
    <script type="module">
        // --- Core Application Variables ---
        const inputField = document.getElementById('inputX');
        const resultBox = document.getElementById('result');

        // Helper for currency formatting
        const formatter = new Intl.NumberFormat('en-IN', {
            style: 'currency',
            currency: 'INR',
            minimumFractionDigits: 0,
            maximumFractionDigits: 0,
        });

        // --- Core Calculation Logic ---
        function calculateDeduction(x) {
            if (isNaN(x) || x <= 0) {
                resultBox.innerHTML = '<p class="text-gray-400 text-center text-lg mt-8">Results will appear here.</p>';
                return;
            }

            // Calculations: 5% deduction, then 20% from the reduced amount
            const initialAmount = Math.round(x);
            const deduction5 = Math.round(initialAmount * 0.05);
            const amountAfter5 = Math.round(initialAmount - deduction5);
            const deduction20 = Math.round(amountAfter5 * 0.20);
            const finalAmount = Math.round(amountAfter5 - deduction20);
            const totalDeducted = Math.round(deduction5 + deduction20);

            // Using Tailwind classes for result display
            resultBox.innerHTML = `
                <div class="space-y-3">
                    <div class="flex justify-between border-b border-blue-300 pb-2">
                        <span class="text-lg text-gray-700 font-semibold">Initial Amount:</span>
                        <span class="text-lg font-bold text-gray-900">${formatter.format(initialAmount)}</span>
                    </div>

                    <div class="flex justify-between text-base text-gray-600">
                        <span>5% Deduction:</span>
                        <span class="text-red-600 font-medium">- ${formatter.format(deduction5)}</span>
                    </div>

                    <div class="flex justify-between text-base text-gray-600">
                        <span>Amount After 5%:</span>
                        <span class="font-medium">${formatter.format(amountAfter5)}</span>
                    </div>

                    <div class="flex justify-between text-base text-gray-600">
                        <span>20% Deduction (from reduced amount):</span>
                        <span class="text-red-600 font-medium">- ${formatter.format(deduction20)}</span>
                    </div>

                    <div class="flex justify-between border-t border-blue-300 pt-3">
                        <span class="text-xl text-blue-600 font-extrabold">FINAL AMOUNT:</span>
                        <span class="text-2xl text-blue-800 font-extrabold">${formatter.format(finalAmount)}</span>
                    </div>

                    <div class="text-center text-sm text-red-500 pt-1">
                        Total Deduction: ${formatter.format(totalDeducted)}
                    </div>
                </div>
            `;
        }

        // --- LocalStorage Write Operation ---
        function saveInput(value) {
            if (value > 0) {
                localStorage.setItem('lastInput', value.toString());
            } else {
                localStorage.removeItem('lastInput');
            }
        }

        // --- Event Handlers ---
        let debounceTimer;
        inputField.addEventListener('input', (e) => {
            const value = parseFloat(e.target.value);
            calculateDeduction(value);

            clearTimeout(debounceTimer);
            // Debounce save operation to prevent excessive calls, though less critical for local storage
            debounceTimer = setTimeout(() => {
                saveInput(value);
            }, 300);
        });


        // --- Initialization: Load from LocalStorage on load ---
        window.onload = function () {
            const savedInput = localStorage.getItem('lastInput');

            if (savedInput) {
                const value = parseFloat(savedInput);
                if (value > 0) {
                    inputField.value = value;
                    calculateDeduction(value);
                }
            }
            // Ensure the input field is focused for immediate typing
            inputField.focus();
        };
    </script>
</body>
</html>
